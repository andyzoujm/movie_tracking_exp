<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <title>Video Annotation Project</title>
    <style type="text/css" media="screen">
      #consent #consentForm {
        width: 100%;
        height: 90%;
        resize: both;
        overflow: auto;
        margin-top: 5px;
        margin-left: 10px;
      }
      #instructionDoc {
        width: 100%;
        height: 90%;
        /*resize: both;*/
        overflow: auto;
        margin-top: 5px;
        margin-left: 10px;
      }
      .bottom-buffer { margin-bottom:10px; }
      .top-buffer { margin-top:10px; }

      #canvasContainer {
        position: relative;
        height: 90%;
      }
      #videoCanvas{
        position: absolute;
        z-index: 1;
        top:0;
        left:0;
      }
      #gridCanvas{
        position: absolute;
        z-index: 1;
        top:0;
        left:0;
      }
      #imageTrack{
        height: 200px;
        /*height:70%;*/
        margin-top: 5px;
        margin-left: 5px;
        margin-bottom: 5px;
        overflow: hidden;
      }
      
      #emotionSpaceImage{
        /*height: 200px;*/
        /*height:70%;*/
        position: absolute;
        z-index: 1;
        height: 500px;
        margin-top: 5px;
        margin-left: 5px;
        margin-bottom: 5px;
        overflow: hidden;
      }
      .spaceText{
        font-size: 12pt;
      }
      .formLabel{
        font-size: 14pt;
      }
      .container{
        margin-right:5px;
        margin-left:5px;
        /*margin-top:5px;*/
        padding-right:5px; 
      }
      /*.page{
        width:1200px;
      }*/
      h3{
        margin-top:5px;
        margin-left:5px;
      }
      p{
        margin-bottom: 0px;
      }

    </style>
  </head>
  <body>
    <main class="container">
      <!-- Consent form page-->
      <div id="consent" class="page container">
        <div class='row bottom-buffer col-md-3'>
          <br/>
          <p class="spaceText"> <b>Google Chrome or Safari is REQUIRED.</b> The experiment may not work with other browsers.</p>
          <br>
          <p class="spaceText"> <b>IMPORTANT</b>: Please drag the corners of your browser to fill the whole screen. This text has to be on the <b>LEFT</b> relative to the consent form (not on top). If not, please restart the browser and open the webpage again. </p>
          <br>
          <input name="consent" onclick="Entrypoint.disableStart(false)" type="radio" value="yes" /> I agree<br />
          <input name="consent" onclick="Entrypoint.disableStart(true)" type="radio" value="no" /> I don&#39;t agree<br />
          <p class="spaceText"> Click 'I agree' then click 'Start' to begin. </p>
          <button disabled type="button" id="agreeAndStart" onclick="Entrypoint.showPage(1)" class="btn btn-lg btn-primary">Start</button>
        </div>
        <div class='row bottom-buffer col-md-9'>
          <center><h3><u><b>Consent Form</b></u></h3></center>
          <iframe frameborder="1" id="consentForm" src="https://docs.google.com/document/d/e/2PACX-1vSuQ2s93qu0sH_HV66kytWfnr6_GCLcSjDz66b0GMOXsxVKvecZ_SvNaDtpOJF3SfcORUWAJ0UCOa-3/pub?embedded=true"></iframe>
          <!--src="https://docs.google.com/document/d/e/2PACX-1vRy5jLV0SIyMFxu5C5GSIUjZhOhkTer82HvIdnUOLb4RcHQA-abD3N-RI5vEv0kcaMJOPS0frWMJuGN/pub?embedded=true"-->
        </div>
      </div>

      <div id="before_start" class="page container">
          <!-- Starting page -->
          <h3><u>Before You Start</u></h3>
          <h4>Please read the following instructions carefully: </h4>
          <p class="spaceText"> Welcome! I am a graduate student in Prof. David Whitney's laboratory. The purpose of this experiment is to study how we perceive other people's emotions using contextual cues in a naturalistic environment. You will be asked to watch video clips and perform a task while watching the video. Please try your best and update your judgment in real time. </p>
          <ul>
            <li><p class="spaceText">There are <span class='totalNumber'> </span> trials/videos maximum in this experiments. Finishing all videos should take about or less than <span class='totalTime'> </span> minutes. We will record how much time you are active in our experiment. Please try to finish all the trials if possible. However, the most important thing is that you perform the task accurately.</li>
            <li><p class="spaceText">Please pay full attention to the experiment. The quality of the data is very important to us. <b><u>Pleaes don't use your cell phone or try to multi-task while doing the experiment. </u></b></p></li>
            <li><p class="spaceText">Please do not close the web page before you finish the experiment. If you accidentally exit the experiment, you can resume the experiment by entering your Berkeley email, and then the program will load your progress. </p></li>
            <li><p class="spaceText"> You <b>WON'T</b> be able to participate again if you have already participated in this study on and after <b>October 31st 2018</b>. We will have to cancel your time slot in that case.</p></li>
            <li><p class="spaceText">Please finish the whole experiment within <b>24 hours</b> after you signed up.</p></li>
            <li><p class="spaceText">You can receive full credits only if you participate for the full <span class='totalTime'> </span> minutes or complete all the trials. Your data will be kept confidential.</p></li>
          </ul>
          <p class="spaceText"> When you finish the whole experiment. We will verify your progress and the time you spent, and assign you credits in 1-2 days.</p>
          <p class="spaceText"> Click 'Next' to view the next page. </p>
          <!-- Navigation buttons -->
          <button id="next" type="button" onclick="Entrypoint.showPage(2)" class="btn btn-lg btn-primary">Next</button>
      </div>

      <div id="getInfo" class="page container">
        <div class='row bottom-buffer'>
          <h3><u> Participant Information </u></h3>
          <p class="spaceText">Please enter your Berkeley email as username. Please double check if your email address is correct before you submit. We use it for the purpose of granting RPP credits and saving progress.</p>
        </div>
        
        <form id='infoForm'>
          <div id="email" class="formField row bottom-buffer">
            <span class="formLabel" >Berkeley Email:</span>
            <input type="text" name="email" size="50" value="@berkeley.edu">
          </div>
          <div class="formField row bottom-buffer">
            <span class="formLabel">Age:</span>
            <input type="text" name="age">
          </div>
          <div class="formField row bottom-buffer">
            <span class="formLabel">Gender:</span>
            <select name="gender" ><option value=""></option><option value="0">Male</option><option value="1">Female</option> <option value="2">Other</option> </select>
          </div>
          <div class="formField row bottom-buffer">
            <span class="formLabel">Expected year of graduation:</span>
            <input type="text" name="yearsGraduate">
          </div>
        </form>
        <div class="row bottom-buffer">
          <p class="spaceText" id = "formText"> Please note that your information is handled as absolutely confedential. </p>
        </div>
        <button id="submitForm" type="button" class="btn btn-lg btn-primary">Submit</button>
      </div>

      <div id="instructions" class="page container">
        <div class='row bottom-buffer col-md-3'>
          <h3><u>Instructions</u></h3>
          <p class="spaceText"><b>IMPORTANT</b>: Please read the document on the right carefully for instructions. If you don't read, you will NOT understand the instructions thoroughly and you will NOT be awarded full credits. </p>
          <br/>
          <p class="spaceText"> Please make sure that you read all instructions by scrolling down to the bottom of the document. You will have at least 5 minutes to read. </p>
          <br/>
          <p class="spaceText"> Click the button to begin when you finish reading the instructions. </p> 
          <br/>
          <button disabled id="beginTrial" type="button" class="btn btn-lg btn-primary" >Begin the experiment</button>
        </div>
        <div class='row bottom-buffer col-md-9'>
          <iframe frameborder="1" id="instructionDoc" src=" "></iframe>
        </div>
      </div>

      <div id="annotation" class="page container">
        <div class='col-xs-4'>
          <h3>Trial <span id='trialNumber'></span> out of <span class='totalNumber'> </span> in total</h3>
          <div id='instructionsButton'>
              <a id = 'viewInstructionButton' href="https://docs.google.com/document/d/1B86DZ3aon9Cw7EH6wOEYoz339kHx9f6iLfaHyHofWfo/edit?usp=sharing" class="btn btn-default" target="_blank">Click to view instructions again.</a>
          </div>
          <p class="spaceText" id = 'InstructionPerson'> The following character will be <b>occluded by a mask</b> and become blurred out in the video. Please infer and track <u><b>the real emotions of this character</b></u> (but <u><b>NOT</b></u> other characters <u><b>NOR</b></u> the general emotion of the clip) <u><b>in real-time</b></u> based on the situation/environment this person is in. </p>
          <p class="spaceText" id = 'InstructionControl'> You will watch a video with the background completely black out and the following character will be <b>occluded by a mask</b> and become blurred out in the video. Please infer and track <u><b>the real emotions of this character</b></u> <u><b>in real-time</b></u> based on the blurry mask. Please pay attention the whole time after starting the video. The mask will appear and disappear at any time. </p>

          <p class="spaceText" id = 'InstructionScene'> One of the characters will be occluded by a mask and become blurred out in the video. Please track <u><b>the affective value of the visual scene itself</b></u> in the video<u><b> in real-time</b></u>. However, please <u><b>DON'T</b></u> track the emotions of the blurred-out character. </p>

          <p class="spaceText" id = 'InstructionBaseline'> Your task is to track the real emotions of the following person while watching the video. Please only <u><b>track this character</b></u> (but <u><b>NOT</b></u> other characters <u><b>NOR</b></u> the general emotion of the clip) <u><b>in real-time.</b></u></p>

          <p class="spaceText" id = 'InstructionCharacterOnly'> You will watch a video with background occluded but the following character remain visible. Your task is to track the real emotions of this character while watching the video. Please track this character <u><b>in real-time.</b></u></p>

          <p class ='spaceText' id = 'characterInvisible'>Even when the character is not on the screen, continue tracking and give your best guess.</p>

          <img id = 'imageTrack' src='img/Exp2_1_baseline.png'/>
         <!--  <div id = 'LoadingVideo'>
            <p class="spaceText"> The video is loading. Please wait a few seconds.</p>
          </div> -->
          <div id='MovieInstruction' hidden>
            <p class="spaceText"> Please track the affective value/emotion <u><b>CLOSELY</b></u> and move the mouse <u><b>CONTINUOUSLY</b></u> </p>
          </div>
          <div id='VideoReady'>
            <p class="spaceText"> Move the mouse pointer to the central cross of the video and press <b>ENTER</b> key to start. </p>
          </div>
          <div id='VideoStart' hidden>
            <p class="spaceText"> The video has paused. Put the mouse point at the center cross and then press the <u><b>ENTER</b></u> key to start</p>
          </div>
          
      </div>
        <div id='videoContainer' class='col-xs-8'>
          <p> <b>IMPORTANT</b>: This text must be visible; please avoid scrolling down because it will interfere with data recording; adjust the browser size so that this window fills the screen; the entire video frame should be visible.</p>
          <div id='canvasContainer'>
            <div id='yt-player'></div>
            <canvas id='videoCanvas' ></canvas>
            <canvas id='gridCanvas'></canvas>
          </div>
        </div>
       
      </div>

      <div id="PostTrialSurvey" class="page container">
        <h3>Feedback</h3>
        <p class="spaceText" id="encourage1" hidden>You did a great job of tracking the emotion closely! </p>
        <p class="spaceText" id="encourage2" hidden>You did an excellent job of tracking closely! </p>
        <p class="spaceText" id="encourage3" hidden>Outstanding work! We appreciate your contribution. </p>
        <p class="spaceText" id="encourage4" hidden>Brilliant job! Please keep going. </p>
        <p class="spaceText" id="encourage5" hidden>Your continous tracking data is wonderful! Thank you! </p>
        <p class="spaceText" id="badJob1" hidden>The longest time you have not moved the red pointer is <b><span id='longestTimeStill'> </span> seconds </p></b>
        <p class="spaceText" id="badJob2" hidden>Your performance was not ideal. Please stay focused and track the emotion more closely.</p>
        <h3>Post-trial Survey</h3>
        <form id='surveyForm'>
          <div class="formField row bottom-buffer">
            <span class="formLabel"> Question 1: Have you ever watched this particular movie clip before participating in the experiment?</span>
            <select name="seenOrNot" ><option value=""></option><option value="0">Yes</option><option value="1">No</option> <option value="2">Not sure</option> </select>
          </div>
          <div class="formField row bottom-buffer">
            <span class="formLabel">Question 2: Please rate your level of familiarity towards the movie clip you just watched: </span>
            <select name="Familiarity" ><option value=""></option><option value="1">1-Not at all familiar</option><option value="2">2-Slightly familiar</option> <option value="3">3-Somewaht familiar</option> <option value="4">4-Moderately familiar</option><option value="5">5-Extremely familiar</option></select>
          </div>

          <div class="formField row bottom-buffer">
            <span class="formLabel">Question 3: Please rate how much do you like or enjoy this movie clip that you just watched: </span>
            <select name="Likeness" ><option value=""></option><option value="1">1-Strongly dislike </option><option value="2">2-Somewhat dislike</option> <option value="3">3-Neutral</option> <option value="4">4-Somewhat like</option><option value="5">5-Strongly like</option></select>
          </div>

          <div class="formField row bottom-buffer">
            <span class="formLabel">Question 4: please rate how confident you are tracking the emotions in this trial: </span>
            <select name="Confidence" ><option value=""></option><option value="1">1-Not at all confident </option><option value="2">2-Not confident</option> <option value="3">3-Somewhat confident, with some errors</option> <option value="4">4-Confident</option><option value="5">5-Very confident </option></select>
          </div>

          <div class="formField row bottom-buffer">
            <span class="formLabel">Question 5: please rate how difficult tracking the emotions in this trial is: </span>
            <select name="Difficulty" ><option value=""></option><option value="1">1-Very easy </option><option value="2">2-Somewhat easy</option> <option value="3">3-Moderate</option> <option value="4">4-Somewhat difficult</option><option value="5">5-Very difficult</option></select>
          </div>

          <button id="submitTrial" type="button" class="btn btn-lg btn-primary">Next trial</button>
        </div>


      <div id="emotionSpace" class="page container">
        <div class='col-xs-3'>
          <h3>Before you start:</h3>
          <p class="spaceText"> Please be familiar with the valence and arousal space on the right before you proceed.</p>
          <br/>
          <p class="spaceText"> You will rate the emotion in two dimensions: Valence refers to how positive or negative a person is, and arousal reflects whether a person is exciting/agitating or calming/soothing. Example words with their locations are shown, indicating their approximate ratings. </p>
          <br/>
          <p class="spaceText"> Click the button to start a trial. </p>
          <br/>
          <button id="startTrial" type="button" class="btn btn-lg btn-primary">Start new trial</button>
        </div>

        <div id='videoContainer' class='col-xs-9'>
            <img id = 'emotionSpaceImage' src='img/Valence_arousal_1.jpg'/>
        </div>
      </div>

      <div id="EndingExp" class="page container">
        <h3><u>You have finished the experiment!</u></h3>
        <p class="spaceText"> Thank you so much!</p>
        <p class="spaceText"> Please send an email to <b>chenzhimin@berkeley.edu</b> with a title <u><b>'Completed Tracking Experiment'</b></u>. We will verify your progress and the time you spent, and assign you credits in 1-2 days. If you encountered any problem or have any suggestion, also feel free to contact the researcher. We appreciate your feedback!</p>
        <p class="spaceText"> If you like our experiment, please recommend it to your classmates and friends. We do need a lot of participants. Thank you!!!</p> 
        <p class="spaceText"> You can close the web page now.</p> 
      </div>

    </main>
  </body>
  <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/core-js/2.1.4/core.min.js"></script>
  <script type="text/javascript" src="bundle.js"></script>


</html>
